function getIosVersion(){if(/iP(hone|od|ad)/.test(navigator.platform)){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]}}function checkIosPlatform(){p=navigator.platform.toLowerCase(),u=navigator.userAgent.toLowerCase(),v=navigator.vendor,"undefined"!=typeof v&&(v=v.toLowerCase());var e=getIosVersion();return(-1!==p.indexOf("ipad")||-1!==p.indexOf("iphone")||-1!==p.indexOf("ipod")||-1!==p.indexOf("mac"))&&"undefined"!=typeof e&&e[0]>=7&&checkSafari(u,v)===!0||-1!==p.indexOf("mac")&&checkSafari(u,v)===!0?(alerts("....... IOS >= 7 or mac&safari... "),!0):!1}function checkSafari(e,t){return-1!==e.indexOf("safari")&&-1!==t.indexOf("apple")?!0:!1}function setCookie(e,t,o){var r=new Date;o=3650,r.setDate(r.getDate()+o);var n="";n=checkIosPlatform()===!0?t+(null==o?"":"; domain=.shoprunner.com; path=/; expires="+r.toUTCString()):t+(null==o?"":"; expires="+r.toUTCString()),document.cookie=e+"="+n}function getCookie(e){var t,o,r,n=document.cookie.split(";");for(t=0;t<n.length;t++)if(o=n[t].substr(0,n[t].indexOf("=")),r=n[t].substr(n[t].indexOf("=")+1),o=o.replace(/^\s+|\s+$/g,""),o==e)return stripped_y=stripQuotes(r),""!==stripped_y&&"undefined"!=typeof stripped_y?unescape(stripped_y):unescape(r)}function stripQuotes(e){return newStr="","undefined"!=typeof e&&(fChar=e.substring(0,1),lChar=e.substring(e.length-1,e.length),start='"'===fChar||"'"===fChar?1:0,end='"'===lChar||"'"===lChar?e.length-1:e.length,newStr=e.substring(start,end)),newStr}function alerts(e){try{"true"===window.localStorage.debug_alerts&&console.log(e)}catch(t){}}function gup(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",o=new RegExp(t),r=o.exec(window.location.href);return null===r?!1:r[1]}function setit(e){if(window.localStorage){try{window.localStorage.sr_ssotoken=e,window.localStorage.sr_ismember=!0}catch(t){alerts("Unable to write to local storage "+t)}alerts("Local Storage SSO set to "+e+".")}setCookie("sr_ssotoken",e,3650),setCookie("sr_ismember",!0,3650),alerts("Cookie SSO set to "+e+".")}function setLocalStorage(e,t){if(window.localStorage)try{window.localStorage[e]=t,alerts("Local Storage "+e+"set to "+t)}catch(o){alerts("Unable to write to local storage "+o)}setCookie(e,t,3650),alerts("Cookie "+e+" set to "+t)}gup("sr_ssotoken")&&""===gup("sr_ssotoken")?setit("false"):gup("sr_ssotoken")&&setit(gup("sr_ssotoken")),gup("sr_website_logout")&&setLocalStorage("sr_website_logout",gup("sr_website_logout"));var sr_$={};sr_$.actions={},function(){var e,t,o,r,n=1,a=!1,s="postMessage",i="addEventListener",l=window[s]&&"undefined"==typeof window.opera;sr_$.actions.postMessage=function(e,t,o){return t?(o=o||parent,l?o[s](e,t.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):t&&(o.location=t.replace(/#.*$/,"")+"#"+ +new Date+n++ +"&"+e),!0):void 0},sr_$.actions.receiveMessage=r=function(n,s,c){l?(n&&(o&&r(),o=function(e){n(e)}),window[i]?window[n?i:"removeEventListener"]("message",o,a):window[n?"attachEvent":"detachEvent"]("onmessage",o)):(e&&clearInterval(e),e=null,n&&(c="number"==typeof s?s:"number"==typeof c?c:100,e=setInterval(function(){var e=document.location.hash,o=/^#?\d+&/;e!==t&&o.test(e)&&(t=e,n({data:e.replace(o,"")}))},c)))}}();var tok=checkIosPlatform()||"undefined"==typeof window.localStorage||""===window.localStorage.sr_ssotoken?getCookie("sr_ssotoken"):window.localStorage.sr_ssotoken,mem=checkIosPlatform()||"undefined"==typeof window.localStorage||""===window.localStorage.sr_ismember?getCookie("sr_ismember"):window.localStorage.sr_ismember;tok&&""!==tok?(sr_$.actions.postMessage('{"sso":"'+tok+'","mem":"'+mem+'"}',gup("purl"),parent),alerts("Sending SSO Token.")):alerts("No SSO Token.");
